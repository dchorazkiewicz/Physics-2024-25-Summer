<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Language of Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Language_of_physics_files/libs/clipboard/clipboard.min.js"></script>
<script src="Language_of_physics_files/libs/quarto-html/quarto.js"></script>
<script src="Language_of_physics_files/libs/quarto-html/popper.min.js"></script>
<script src="Language_of_physics_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Language_of_physics_files/libs/quarto-html/anchor.min.js"></script>
<link href="Language_of_physics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Language_of_physics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Language_of_physics_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Language_of_physics_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Language_of_physics_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#weather-data-visualization" id="toc-weather-data-visualization" class="nav-link" data-scroll-target="#weather-data-visualization">Weather Data Visualization</a></li>
  <li><a href="#scalar-fields" id="toc-scalar-fields" class="nav-link" data-scroll-target="#scalar-fields">Scalar Fields</a>
  <ul>
  <li><a href="#example-temperature-on-a-surface" id="toc-example-temperature-on-a-surface" class="nav-link" data-scroll-target="#example-temperature-on-a-surface">Example: Temperature on a surface</a></li>
  </ul></li>
  <li><a href="#vector-fields" id="toc-vector-fields" class="nav-link" data-scroll-target="#vector-fields">Vector Fields</a>
  <ul>
  <li><a href="#example-static-vector-field" id="toc-example-static-vector-field" class="nav-link" data-scroll-target="#example-static-vector-field">Example: Static vector field</a></li>
  </ul></li>
  <li><a href="#derivatives-and-integrals" id="toc-derivatives-and-integrals" class="nav-link" data-scroll-target="#derivatives-and-integrals">Derivatives and Integrals</a>
  <ul>
  <li><a href="#derivatives" id="toc-derivatives" class="nav-link" data-scroll-target="#derivatives">Derivatives</a>
  <ul class="collapse">
  <li><a href="#derivative-of-functions-of-one-variable" id="toc-derivative-of-functions-of-one-variable" class="nav-link" data-scroll-target="#derivative-of-functions-of-one-variable">Derivative of functions of one variable</a></li>
  <li><a href="#derivative-of-functions-of-two-variables" id="toc-derivative-of-functions-of-two-variables" class="nav-link" data-scroll-target="#derivative-of-functions-of-two-variables">Derivative of functions of two variables</a></li>
  </ul></li>
  <li><a href="#integrals" id="toc-integrals" class="nav-link" data-scroll-target="#integrals">Integrals</a></li>
  </ul></li>
  <li><a href="#differential-equations" id="toc-differential-equations" class="nav-link" data-scroll-target="#differential-equations">Differential equations</a>
  <ul>
  <li><a href="#starting-example" id="toc-starting-example" class="nav-link" data-scroll-target="#starting-example">Starting example</a>
  <ul class="collapse">
  <li><a href="#check-in-geogebra" id="toc-check-in-geogebra" class="nav-link" data-scroll-target="#check-in-geogebra">Check in geogebra:</a></li>
  </ul></li>
  <li><a href="#second-order-differential-equations" id="toc-second-order-differential-equations" class="nav-link" data-scroll-target="#second-order-differential-equations">Second order differential equations</a>
  <ul class="collapse">
  <li><a href="#numerical-solution-1" id="toc-numerical-solution-1" class="nav-link" data-scroll-target="#numerical-solution-1">Numerical solution</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Language of Physics</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Physics often describes the universe and its phenomena using the language of mathematics, where the Cartesian 3D space serves as the natural stage for physical events. This spatial representation, defined by three orthogonal axes <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span>, is the starting point for our exploration. By reducing the dimensionality to 2D, we simplify the analysis, enabling a focused study of structures that arise in such spaces. This reduction is not merely an abstraction but also a practical tool for understanding the behaviors and interactions within physical systems.</p>
</section>
<section id="weather-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="weather-data-visualization">Weather Data Visualization</h2>
<p>Interactive weather maps serve as an excellent introduction to the fundamental ideas required to study physics. If one can interpret these maps, they will find it easier to grasp the basic concepts of scalar and vector fields, which are central to understanding physical systems.</p>
<p>On such maps, temperature is represented using a color gradient, where each color corresponds to a specific value at a given point in space. This visualization aligns with the definition of a <strong>scalar field</strong>, which assigns a single numerical value to each point in space.</p>
<p>Similarly, wind patterns are illustrated using moving line segments, where their length and direction represent the speed and direction of the wind at various points. These segments directly depict <strong>vector fields</strong>, as they assign a vector—defined by both magnitude and direction—to each point in space. Since the magnitude is expressed as a numerical value, the background color can be used to represent the magnitude of the vector field.</p>
<iframe width="650" height="450" src="https://embed.windy.com/embed2.html" frameborder="0" data-external="1"></iframe>

<p><a href="https://www.windy.com/">www.windy.com</a></p>
<p>Having this background, we can now delve into the mathematical representations of scalar and vector fields in 2D space. Let us use more formal definitions to understand these concepts better.</p>
</section>
<section id="scalar-fields" class="level2">
<h2 class="anchored" data-anchor-id="scalar-fields">Scalar Fields</h2>
<p>A scalar field associates a single real value to every point in a given space. In 2D, this can be represented as a function <span class="math inline">\(T(x, y)\)</span>, where <span class="math inline">\(T\)</span> could represent a physical property like temperature.</p>
<section id="example-temperature-on-a-surface" class="level3">
<h3 class="anchored" data-anchor-id="example-temperature-on-a-surface">Example: Temperature on a surface</h3>
<p>Consider a simple model where the temperature of a surface varies with both position and time:</p>
<p><span class="math display">\[
T(x, y) = 5 \sin(x) \cos(y)
\]</span></p>
<p>Below is a Python code of this scalar field:</p>
<div id="311330d1" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Scalar field definition</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">def</span> scalar_field(x, y):</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="cf">return</span>  <span class="dv">5</span> <span class="op">*</span> np.sin(x) <span class="op">*</span> np.cos(y)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># Generate grid points</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># Compute scalar field values</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>T <span class="op">=</span> scalar_field(x, y)</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># Plot the scalar field</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1-18"><a href="#cb1-18"></a>plt.imshow(T, extent<span class="op">=</span>[<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>], origin<span class="op">=</span><span class="st">'lower'</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a>plt.colorbar(label<span class="op">=</span><span class="st">"Temperature"</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a>plt.xlabel(<span class="st">"X-axis"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a>plt.ylabel(<span class="st">"Y-axis"</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>plt.title(<span class="st">"Temperature Distribution on a Surface"</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-2-output-1.png" width="609" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Above example defines a scalar field that do not depend on time. As we can see on weather maps, scalar fields can also be time-dependent, where the value of the field changes with time.</p>
<p>To define a time-dependent scalar field, we can modify the previous example by adding explicit time dependence:</p>
<p><span class="math display">\[
T(x, y, t) = 5 \sin(x) \cos(y) e^{-t}
\]</span></p>
<p>Now the temperature at each point <span class="math inline">\((x, y)\)</span> decays exponentially with time. To visualize this field, we can use the following Python or Geogebra code in 3D calculator:</p>
<div class="geogebra-instruction">
<ul>
<li>t=Slider[0,10,0.01]</li>
<li>T(x,y)=5<em>sin(x)</em>cos(y)*exp(-t)</li>
</ul>
</div>
<p>Or we can use the following Python code to grasp 4 time steps:</p>
<div id="472b0f06" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Scalar field definition</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">def</span> scalar_field(x, y, t):</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="cf">return</span> <span class="dv">5</span> <span class="op">*</span> np.sin(x) <span class="op">*</span> np.cos(y) <span class="op">*</span> np.exp(<span class="op">-</span>t)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Generate grid points</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Compute scalar field values for 4 time steps</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>T <span class="op">=</span> np.zeros((<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">4</span>))</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb2-16"><a href="#cb2-16"></a>    T[:, :, i] <span class="op">=</span> scalar_field(x, y, i)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Determine common color scale</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>vmin <span class="op">=</span> np.<span class="bu">min</span>(T)</span>
<span id="cb2-20"><a href="#cb2-20"></a>vmax <span class="op">=</span> np.<span class="bu">max</span>(T)</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co"># Plot the scalar field for 4 time steps</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co"># Store the last image for the colorbar</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>im <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-27"><a href="#cb2-27"></a></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axs.flat):</span>
<span id="cb2-29"><a href="#cb2-29"></a>    ax.grid(<span class="va">False</span>)  <span class="co"># Explicitly disable gridlines</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>    im <span class="op">=</span> ax.imshow(T[:, :, i], extent<span class="op">=</span>[<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>], origin<span class="op">=</span><span class="st">'lower'</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax)</span>
<span id="cb2-31"><a href="#cb2-31"></a>    ax.set_title(<span class="ss">f"Temperature Distribution at t=</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a>    ax.set_xlabel(<span class="st">"X-axis"</span>)</span>
<span id="cb2-33"><a href="#cb2-33"></a>    ax.set_ylabel(<span class="st">"Y-axis"</span>)</span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co"># Adjust layout to fit a colorbar outside the plots</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>fig.subplots_adjust(right<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb2-37"><a href="#cb2-37"></a>cbar_ax <span class="op">=</span> fig.add_axes([<span class="fl">0.88</span>, <span class="fl">0.15</span>, <span class="fl">0.02</span>, <span class="fl">0.7</span>])  <span class="co"># Define a new axis for the colorbar</span></span>
<span id="cb2-38"><a href="#cb2-38"></a>cbar <span class="op">=</span> fig.colorbar(im, cax<span class="op">=</span>cbar_ax)</span>
<span id="cb2-39"><a href="#cb2-39"></a>cbar.set_label(<span class="st">"Temperature"</span>)</span>
<span id="cb2-40"><a href="#cb2-40"></a></span>
<span id="cb2-41"><a href="#cb2-41"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-3-output-1.png" width="1007" height="943" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="vector-fields" class="level2">
<h2 class="anchored" data-anchor-id="vector-fields">Vector Fields</h2>
<p>A vector field assigns a vector to every point in space. In 2D, such a field can be represented as</p>
<p><span class="math display">\[\vec{F}(x, y) = (F_x(x, y), F_y(x, y))\]</span></p>
<p>where <span class="math inline">\(F_x\)</span> and <span class="math inline">\(F_y\)</span> are the components of the vector field. Both may depend on the position <span class="math inline">\((x, y)\)</span>.</p>
<section id="example-static-vector-field" class="level3">
<h3 class="anchored" data-anchor-id="example-static-vector-field">Example: Static vector field</h3>
<p>Let us examine a vector field that depends on both space and time:</p>
<p><span class="math display">\[
\vec{F}(x, y) = (\sin(y), \sqrt{\frac{|x|}{5}})
\]</span></p>
<p>This field might represent the velocity of a fluid at each point <span class="math inline">\((x, y)\)</span> in a 2D space. Below is a Python code to visualize this vector field:</p>
<div id="58cfd88d" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Definition of the vector field</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">def</span> vector_field(x, y):</span>
<span id="cb3-6"><a href="#cb3-6"></a>    Fx <span class="op">=</span> np.sin(y)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    Fy <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(x)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="cf">return</span> Fx, Fy</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># Generating a grid of points</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">16</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">16</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co"># Calculating the vector field</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>Fx, Fy <span class="op">=</span> vector_field(x, y)</span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co"># Calculating the lengths of the vectors</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>d_lengths <span class="op">=</span> np.sqrt(Fx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Fy<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co"># Initializing the plot</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb3-23"><a href="#cb3-23"></a>quiver <span class="op">=</span> ax.quiver(</span>
<span id="cb3-24"><a href="#cb3-24"></a>    x, y, Fx, Fy, d_lengths, angles<span class="op">=</span><span class="st">'xy'</span>, scale_units<span class="op">=</span><span class="st">'xy'</span>, scale<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span><span class="st">'viridis'</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>)</span>
<span id="cb3-26"><a href="#cb3-26"></a>cb <span class="op">=</span> fig.colorbar(quiver, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Vector length"</span>)</span>
<span id="cb3-27"><a href="#cb3-27"></a>ax.set_xlim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>ax.set_ylim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb3-29"><a href="#cb3-29"></a>ax.set_xlabel(<span class="st">"X axis"</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a>ax.set_ylabel(<span class="st">"Y axis"</span>)</span>
<span id="cb3-31"><a href="#cb3-31"></a>ax.set_title(<span class="st">"2D vector field with color dependent on vector length"</span>)</span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-4-output-1.png" width="525" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Stream plot</p>
<div id="b548234e" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Definition of the vector field</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">def</span> vector_field(x, y):</span>
<span id="cb4-6"><a href="#cb4-6"></a>    Fx <span class="op">=</span> np.sin(y)</span>
<span id="cb4-7"><a href="#cb4-7"></a>    Fy <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(x)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="cf">return</span> Fx, Fy</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Generating a grid of points</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">100</span>)  <span class="co"># Higher resolution for streamlines</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">100</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co"># Calculating the vector field</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>Fx, Fy <span class="op">=</span> vector_field(x, y)</span>
<span id="cb4-17"><a href="#cb4-17"></a>d_lengths <span class="op">=</span> np.sqrt(Fx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Fy<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co"># Streamplot (Streamlines)</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb4-21"><a href="#cb4-21"></a>stream <span class="op">=</span> ax.streamplot(</span>
<span id="cb4-22"><a href="#cb4-22"></a>    x[<span class="dv">0</span>, :], y[:, <span class="dv">0</span>], Fx, Fy, color<span class="op">=</span>d_lengths, cmap<span class="op">=</span><span class="st">'viridis'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>)</span>
<span id="cb4-24"><a href="#cb4-24"></a>cb <span class="op">=</span> fig.colorbar(stream.lines, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Vector length"</span>)</span>
<span id="cb4-25"><a href="#cb4-25"></a>ax.set_xlim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb4-26"><a href="#cb4-26"></a>ax.set_ylim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb4-27"><a href="#cb4-27"></a>ax.set_xlabel(<span class="st">"X axis"</span>)</span>
<span id="cb4-28"><a href="#cb4-28"></a>ax.set_ylabel(<span class="st">"Y axis"</span>)</span>
<span id="cb4-29"><a href="#cb4-29"></a>ax.set_title(<span class="st">"2D Vector Field with Streamlines"</span>)</span>
<span id="cb4-30"><a href="#cb4-30"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-5-output-1.png" width="534" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="derivatives-and-integrals" class="level2">
<h2 class="anchored" data-anchor-id="derivatives-and-integrals">Derivatives and Integrals</h2>
<section id="derivatives" class="level3">
<h3 class="anchored" data-anchor-id="derivatives">Derivatives</h3>
<section id="derivative-of-functions-of-one-variable" class="level4">
<h4 class="anchored" data-anchor-id="derivative-of-functions-of-one-variable">Derivative of functions of one variable</h4>
<p>The derivative of a function <span class="math inline">\(f(x)\)</span> with respect to <span class="math inline">\(x\)</span> is defined as</p>
<p><span class="math display">\[
\frac{df(x)}{dx} = \lim_{h \to 0} \frac{f(x + h) - f(x)}{h}
\]</span></p>
<p>This limit represents the rate of change of the function <span class="math inline">\(f(x)\)</span> with respect to <span class="math inline">\(x\)</span>. The derivative is a measure of how the function changes as <span class="math inline">\(x\)</span> changes. The derivative can be interpreted as the slope of the function at a given point. The derivative is a function that gives the slope of the function at each point.</p>
</section>
<section id="derivative-of-functions-of-two-variables" class="level4">
<h4 class="anchored" data-anchor-id="derivative-of-functions-of-two-variables">Derivative of functions of two variables</h4>
<p>The derivative of a function <span class="math inline">\(f(x, y)\)</span> with respect to <span class="math inline">\(x\)</span> is defined as</p>
<p><span class="math display">\[
\frac{\partial f(x, y)}{\partial x} = \lim_{h \to 0} \frac{f(x + h, y) - f(x, y)}{h}
\]</span></p>
<p>This limit represents the rate of change of the function <span class="math inline">\(f(x, y)\)</span> with respect to <span class="math inline">\(x\)</span>. The derivative is a measure of how the function changes as <span class="math inline">\(x\)</span> changes. This describes how the function changes in the <span class="math inline">\(x\)</span> direction.</p>
<p>Similarly, the derivative of a function <span class="math inline">\(f(x, y)\)</span> with respect to <span class="math inline">\(y\)</span> is defined as</p>
<p><span class="math display">\[
\frac{\partial f(x, y)}{\partial y} = \lim_{h \to 0} \frac{f(x, y + h) - f(x, y)}{h}
\]</span></p>
<p>This limit represents the rate of change of the function <span class="math inline">\(f(x, y)\)</span> with respect to <span class="math inline">\(y\)</span>. The derivative is a measure of how the function changes as <span class="math inline">\(y\)</span> changes. This describes how the function changes in the <span class="math inline">\(y\)</span> direction.</p>
</section>
</section>
<section id="integrals" class="level3">
<h3 class="anchored" data-anchor-id="integrals">Integrals</h3>
<p>At the simplest level, an integral is the reverse of a derivative. The integral of a function <span class="math inline">\(f(x)\)</span> with respect to <span class="math inline">\(x\)</span> is defined as</p>
<p><span class="math display">\[
\int f(x) dx = F(x) + C
\]</span></p>
<p>where <span class="math inline">\(F(x)\)</span> is the antiderivative of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(C\)</span> is an integration constant. The antiderivative is a function whose derivative is equal to <span class="math inline">\(f(x)\)</span>:</p>
<p><span class="math display">\[
\frac{dF(x)}{dx} = f(x)
\]</span></p>
<p>The integral is a measure of the area under the curve of the function <span class="math inline">\(f(x)\)</span>. The integral is a function that gives the area under the curve of the function <span class="math inline">\(f(x)\)</span> up to a given point.</p>
</section>
</section>
<section id="differential-equations" class="level2">
<h2 class="anchored" data-anchor-id="differential-equations">Differential equations</h2>
<section id="starting-example" class="level3">
<h3 class="anchored" data-anchor-id="starting-example">Starting example</h3>
<p>Let’s consider the first order differential equation</p>
<div class="equation-box">
<p><span class="math display">\[
\frac{dy(x)}{dx} = 2x
\]</span></p>
</div>
<p>Let us think how we should read this equation. The left hand side is the derivative of the function <span class="math inline">\(y(x)\)</span> with respect to <span class="math inline">\(x\)</span>. This derivative is equal to 3. This means that the slope of the function <span class="math inline">\(y(x)\)</span> is constant and equal to 3. This is a simple differential equation that can be solved by integration. The solution is</p>
<p><span class="math display">\[
y(x) = x^2 + C
\]</span></p>
<p>where <span class="math inline">\(C\)</span> is an integration constant. This is the general solution of the differential equation. The solution is not unique because the constant <span class="math inline">\(C\)</span> can take any value. The solution is a straight line with slope 3. The constant <span class="math inline">\(C\)</span> determines the position of the line in the <span class="math inline">\(y\)</span>-axis.</p>
<div id="266290e2" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">def</span> y(x, C):</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> C</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="cf">for</span> C <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">10</span>):</span>
<span id="cb5-12"><a href="#cb5-12"></a>    plt.plot(x, y(x, C), label<span class="op">=</span><span class="ss">f'C=</span><span class="sc">{</span>C<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a>plt.ylabel(<span class="st">'y'</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-6-output-1.png" width="521" height="356" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="check-in-geogebra" class="level4">
<h4 class="anchored" data-anchor-id="check-in-geogebra">Check in geogebra:</h4>
<div class="geogebra-instruction">
<ul>
<li>f(x) = x^2 + 3</li>
</ul>
</div>
<section id="numerical-solution" class="level5">
<h5 class="anchored" data-anchor-id="numerical-solution">Numerical solution</h5>
<p>Remember that derivatives can be approximated by finite differences. The derivative of a function <span class="math inline">\(f(x)\)</span> can be approximated by</p>
<p><span class="math display">\[
\frac{df(x)}{dx} \approx \frac{f(x + h) - f(x)}{h}
\]</span></p>
<p>where <span class="math inline">\(h\)</span> is a small number. This is a simple way to approximate the derivative of a function. Let’s use this approximation to solve the differential equation</p>
<p><span class="math display">\[
\frac{dy(x)}{dx} = 2x
\]</span></p>
<p>We can approximate the derivative by</p>
<p><span class="math display">\[
\frac{y(x + h) - y(x)}{h} = 2x
\]</span></p>
<p>This equation can be solved for <span class="math inline">\(y(x + h)\)</span></p>
<p><span class="math display">\[
y(x + h) = y(x) + 2xh
\]</span></p>
<p>This equation can be used to solve the differential equation numerically. We can start from an initial value of <span class="math inline">\(y(x)\)</span> and use the equation above to calculate the value of <span class="math inline">\(y(x + h)\)</span>. This value can be used to calculate the next value of <span class="math inline">\(y(x + 2h)\)</span> and so on. This is a simple numerical method to solve differential equations.</p>
<p>Let us compare the numerical solution with the analytical solution.</p>
<div id="61a5e09a" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Define the derivative dy/dx</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">def</span> dy_dx(x):</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> x</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># Define the exact analytical solution y(x) for comparison</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">def</span> y_analytical(x):</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># Define a numerical solution for y(x) using the forward Euler method</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="kw">def</span> y_numerical(x, h):</span>
<span id="cb6-14"><a href="#cb6-14"></a>    y <span class="op">=</span> [<span class="dv">0</span>]  <span class="co"># Initialize y with the starting value, assuming y(0) = 0</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb6-16"><a href="#cb6-16"></a>        y.append(y[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> dy_dx(x[i]) <span class="op">*</span> h)  <span class="co"># Update y using dy/dx</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>    <span class="cf">return</span> y</span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co"># Set up the x values</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>plot_x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a>h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]  <span class="co"># Step size</span></span>
<span id="cb6-23"><a href="#cb6-23"></a></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co"># Compute the difference between analytical and numerical solutions</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>difference <span class="op">=</span> y_analytical(x) <span class="op">-</span> np.array(y_numerical(x, h))</span>
<span id="cb6-26"><a href="#cb6-26"></a></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co"># Set up the figure with two subplots</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb6-29"><a href="#cb6-29"></a></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co"># Left plot: Analytical and numerical solutions</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>axs[<span class="dv">0</span>].plot(plot_x, y_analytical(plot_x), label<span class="op">=</span><span class="st">'Analytical'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-32"><a href="#cb6-32"></a>axs[<span class="dv">0</span>].scatter(x, y_numerical(x, h), label<span class="op">=</span><span class="st">'Numerical'</span>, linestyle<span class="op">=</span><span class="st">'solid'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb6-33"><a href="#cb6-33"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Analytical vs Numerical'</span>)</span>
<span id="cb6-34"><a href="#cb6-34"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb6-35"><a href="#cb6-35"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb6-36"><a href="#cb6-36"></a>axs[<span class="dv">0</span>].legend()</span>
<span id="cb6-37"><a href="#cb6-37"></a></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co"># Right plot: Difference between solutions</span></span>
<span id="cb6-39"><a href="#cb6-39"></a>axs[<span class="dv">1</span>].scatter(x, difference, label<span class="op">=</span><span class="st">'Difference'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb6-40"><a href="#cb6-40"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Difference (Analytical - Numerical)'</span>)</span>
<span id="cb6-41"><a href="#cb6-41"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb6-42"><a href="#cb6-42"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Difference'</span>)</span>
<span id="cb6-43"><a href="#cb6-43"></a>axs[<span class="dv">1</span>].legend()</span>
<span id="cb6-44"><a href="#cb6-44"></a></span>
<span id="cb6-45"><a href="#cb6-45"></a><span class="co"># Adjust layout and show the plots</span></span>
<span id="cb6-46"><a href="#cb6-46"></a>plt.tight_layout()</span>
<span id="cb6-47"><a href="#cb6-47"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-7-output-1.png" width="950" height="758" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Difference between the analytical and numerical solutions depends on the step size <span class="math inline">\(h\)</span>.</p>
</section>
</section>
</section>
<section id="second-order-differential-equations" class="level3">
<h3 class="anchored" data-anchor-id="second-order-differential-equations">Second order differential equations</h3>
<p>Let’s consider the second order differential equation</p>
<p><span class="math display">\[
\frac{d^2y(x)}{dx^2} = -y(x)
\]</span></p>
<p>This is a simple differential equation that can be solved by integration. The solution is</p>
<p><span class="math display">\[
y(x) = A \sin(x) + B \cos(x)
\]</span></p>
<p>where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are integration constants. This is the general solution of the differential equation. The solution is not unique because the constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> can take any value. The solution is a sinusoidal function. The constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> determine the amplitude and phase of the sinusoidal function.</p>
<section id="numerical-solution-1" class="level4">
<h4 class="anchored" data-anchor-id="numerical-solution-1">Numerical solution</h4>
<p>From Taylor’s theorem, we know that the second derivative of a function <span class="math inline">\(f(x)\)</span> can be approximated by</p>
<p><span class="math display">\[
f(x + h) = f(x) + h \frac{df(x)}{dx} + \frac{h^2}{2} \frac{d^2f(x)}{dx^2} + \ldots
\]</span></p>
<p>also</p>
<p><span class="math display">\[
f(x - h) = f(x) - h \frac{df(x)}{dx} + \frac{h^2}{2} \frac{d^2f(x)}{dx^2} + \ldots
\]</span></p>
<p>adding these two equations we get</p>
<p><span class="math display">\[
f(x + h) + f(x - h) = 2 f(x) + h^2 \frac{d^2f(x)}{dx^2}
\]</span></p>
<p>so we can approximate the second derivative by</p>
<p><span class="math display">\[
\frac{f(x + h) + f(x - h) - 2 f(x)}{h^2} \approx \frac{d^2f(x)}{dx^2}
\]</span></p>
<p>Let’s use this approximation to solve the differential equation</p>
<p><span class="math display">\[
\frac{d^2y(x)}{dx^2} = -y(x)
\]</span></p>
<p>We can approximate the second derivative by</p>
<p><span class="math display">\[
\frac{y(x + h) + y(x - h) - 2 y(x)}{h^2} = -y(x)
\]</span></p>
<p>This equation can be solved for <span class="math inline">\(y(x + h)\)</span></p>
<p><span class="math display">\[
y(x + h) = 2 y(x) - y(x - h) - h^2 y(x)
\]</span></p>
<p>This equation can be used to solve the differential equation numerically. We can start from an initial value of <span class="math inline">\(y(x)\)</span> and <span class="math inline">\(y(x - h)\)</span> and use the equation above to calculate the value of <span class="math inline">\(y(x + h)\)</span>. This value can be used to calculate the next value of <span class="math inline">\(y(x + 2h)\)</span> and so on. This is a simple numerical method to solve differential equations.</p>
<p>Let us compare the numerical solution with the analytical solution.</p>
<div id="e80c3cae" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Define the second derivative d^2y/dx^2</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">def</span> d2y_dx2(x):</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="cf">return</span> <span class="op">-</span>x</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># Define the exact analytical solution y(x) for comparison</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="kw">def</span> y_analytical(x):</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="cf">return</span> <span class="op">-</span>np.sin(x)</span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co"># Define a numerical solution for y(x) using the forward Euler method</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="kw">def</span> y_numerical(x, h):</span>
<span id="cb7-14"><a href="#cb7-14"></a>    y <span class="op">=</span> [<span class="dv">0</span>, np.sin(<span class="op">-</span>h)]  <span class="co"># Initialize y with the starting values, assuming y(0) = 0 and y(-h) = sin(-h)</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb7-16"><a href="#cb7-16"></a>        y.append(<span class="dv">2</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> y[<span class="op">-</span><span class="dv">2</span>] <span class="op">-</span> h<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>])  <span class="co"># Update y using d^2y/dx^2</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="cf">return</span> y</span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co"># Set up the x values</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>plot_x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb7-21"><a href="#cb7-21"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]  <span class="co"># Step size</span></span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co"># Compute the difference between analytical and numerical solutions</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>difference <span class="op">=</span> y_analytical(x) <span class="op">-</span> np.array(y_numerical(x, h))</span>
<span id="cb7-26"><a href="#cb7-26"></a></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co"># Set up the figure with two subplots</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb7-29"><a href="#cb7-29"></a></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co"># Left plot: Analytical and numerical solutions</span></span>
<span id="cb7-31"><a href="#cb7-31"></a>axs[<span class="dv">0</span>].plot(plot_x, y_analytical(plot_x), label<span class="op">=</span><span class="st">'Analytical'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-32"><a href="#cb7-32"></a>axs[<span class="dv">0</span>].scatter(x, y_numerical(x, h), label<span class="op">=</span><span class="st">'Numerical'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb7-33"><a href="#cb7-33"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Analytical vs Numerical'</span>)</span>
<span id="cb7-34"><a href="#cb7-34"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb7-35"><a href="#cb7-35"></a></span>
<span id="cb7-36"><a href="#cb7-36"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb7-37"><a href="#cb7-37"></a>axs[<span class="dv">0</span>].legend()</span>
<span id="cb7-38"><a href="#cb7-38"></a></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="co"># Right plot: Difference between solutions</span></span>
<span id="cb7-40"><a href="#cb7-40"></a>axs[<span class="dv">1</span>].scatter(x, difference, label<span class="op">=</span><span class="st">'Difference'</span>)</span>
<span id="cb7-41"><a href="#cb7-41"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Difference (Analytical - Numerical)'</span>)</span>
<span id="cb7-42"><a href="#cb7-42"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb7-43"><a href="#cb7-43"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Difference'</span>)</span>
<span id="cb7-44"><a href="#cb7-44"></a>axs[<span class="dv">1</span>].legend()</span>
<span id="cb7-45"><a href="#cb7-45"></a></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="co"># Adjust layout and show the plots</span></span>
<span id="cb7-47"><a href="#cb7-47"></a>plt.tight_layout()</span>
<span id="cb7-48"><a href="#cb7-48"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Language_of_physics_files/figure-html/cell-8-output-1.png" width="950" height="758" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="an">title:</span><span class="co"> Language of Physics</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="an">format:</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">  html:</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">    theme: flatly</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">    toc: true</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">    highlight-style: tango</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">    code-fold: show</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">    code-tools: true</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">    code-block-bg: "rgba(42, 174, 42, 0.02)"</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">    code-block-border-left: "#2aae2a"</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">    code-language-label: true</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">    css: styles.css</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">    math: mathjax</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">    # self-contained: true</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">---</span></span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="fu">## Introduction</span></span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a>Physics often describes the universe and its phenomena using the language of mathematics, where the Cartesian 3D space serves as the natural stage for physical events. This spatial representation, defined by three orthogonal axes $x$, $y$, and $z$, is the starting point for our exploration. By reducing the dimensionality to 2D, we simplify the analysis, enabling a focused study of structures that arise in such spaces. This reduction is not merely an abstraction but also a practical tool for understanding the behaviors and interactions within physical systems.</span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="fu">## Weather Data Visualization</span></span>
<span id="cb8-27"><a href="#cb8-27"></a></span>
<span id="cb8-28"><a href="#cb8-28"></a>Interactive weather maps serve as an excellent introduction to the fundamental ideas required to study physics. If one can interpret these maps, they will find it easier to grasp the basic concepts of scalar and vector fields, which are central to understanding physical systems.</span>
<span id="cb8-29"><a href="#cb8-29"></a></span>
<span id="cb8-30"><a href="#cb8-30"></a>On such maps, temperature is represented using a color gradient, where each color corresponds to a specific value at a given point in space. This visualization aligns with the definition of a **scalar field**, which assigns a single numerical value to each point in space. </span>
<span id="cb8-31"><a href="#cb8-31"></a></span>
<span id="cb8-32"><a href="#cb8-32"></a>Similarly, wind patterns are illustrated using moving line segments, where their length and direction represent the speed and direction of the wind at various points. These segments directly depict **vector fields**, as they assign a vector—defined by both magnitude and direction—to each point in space. Since the magnitude is expressed as a numerical value, the background color can be used to represent the magnitude of the vector field.</span>
<span id="cb8-33"><a href="#cb8-33"></a></span>
<span id="cb8-34"><a href="#cb8-34"></a></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="in">```{=html}</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="in">&lt;iframe width="650" height="450" src="https://embed.windy.com/embed2.html" frameborder="0" data-external="1"&gt;&lt;/iframe&gt;</span></span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="in">```</span></span>
<span id="cb8-39"><a href="#cb8-39"></a></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">[</span><span class="ot">www.windy.com</span><span class="co">](https://www.windy.com/)</span></span>
<span id="cb8-41"><a href="#cb8-41"></a></span>
<span id="cb8-42"><a href="#cb8-42"></a></span>
<span id="cb8-43"><a href="#cb8-43"></a>Having this background, we can now delve into the mathematical representations of scalar and vector fields in 2D space. Let us use more formal definitions to understand these concepts better.</span>
<span id="cb8-44"><a href="#cb8-44"></a></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="fu">## Scalar Fields</span></span>
<span id="cb8-46"><a href="#cb8-46"></a></span>
<span id="cb8-47"><a href="#cb8-47"></a>A scalar field associates a single real value to every point in a given space. In 2D, this can be represented as a function $T(x, y)$, where $T$ could represent a physical property like temperature.</span>
<span id="cb8-48"><a href="#cb8-48"></a></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="fu">### Example: Temperature on a surface</span></span>
<span id="cb8-50"><a href="#cb8-50"></a></span>
<span id="cb8-51"><a href="#cb8-51"></a>Consider a simple model where the temperature of a surface varies with both position and time:</span>
<span id="cb8-52"><a href="#cb8-52"></a></span>
<span id="cb8-53"><a href="#cb8-53"></a>$$</span>
<span id="cb8-54"><a href="#cb8-54"></a>T(x, y) = 5 \sin(x) \cos(y)</span>
<span id="cb8-55"><a href="#cb8-55"></a>$$</span>
<span id="cb8-56"><a href="#cb8-56"></a></span>
<span id="cb8-57"><a href="#cb8-57"></a>Below is a Python code of this scalar field:</span>
<span id="cb8-58"><a href="#cb8-58"></a></span>
<span id="cb8-61"><a href="#cb8-61"></a><span class="in">```{python}</span></span>
<span id="cb8-62"><a href="#cb8-62"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-63"><a href="#cb8-63"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-64"><a href="#cb8-64"></a></span>
<span id="cb8-65"><a href="#cb8-65"></a><span class="co"># Scalar field definition</span></span>
<span id="cb8-66"><a href="#cb8-66"></a><span class="kw">def</span> scalar_field(x, y):</span>
<span id="cb8-67"><a href="#cb8-67"></a>    <span class="cf">return</span>  <span class="dv">5</span> <span class="op">*</span> np.sin(x) <span class="op">*</span> np.cos(y)</span>
<span id="cb8-68"><a href="#cb8-68"></a></span>
<span id="cb8-69"><a href="#cb8-69"></a><span class="co"># Generate grid points</span></span>
<span id="cb8-70"><a href="#cb8-70"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb8-71"><a href="#cb8-71"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb8-72"><a href="#cb8-72"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb8-73"><a href="#cb8-73"></a></span>
<span id="cb8-74"><a href="#cb8-74"></a><span class="co"># Compute scalar field values</span></span>
<span id="cb8-75"><a href="#cb8-75"></a>T <span class="op">=</span> scalar_field(x, y)</span>
<span id="cb8-76"><a href="#cb8-76"></a></span>
<span id="cb8-77"><a href="#cb8-77"></a><span class="co"># Plot the scalar field</span></span>
<span id="cb8-78"><a href="#cb8-78"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb8-79"><a href="#cb8-79"></a>plt.imshow(T, extent<span class="op">=</span>[<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>], origin<span class="op">=</span><span class="st">'lower'</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>)</span>
<span id="cb8-80"><a href="#cb8-80"></a>plt.colorbar(label<span class="op">=</span><span class="st">"Temperature"</span>)</span>
<span id="cb8-81"><a href="#cb8-81"></a>plt.xlabel(<span class="st">"X-axis"</span>)</span>
<span id="cb8-82"><a href="#cb8-82"></a>plt.ylabel(<span class="st">"Y-axis"</span>)</span>
<span id="cb8-83"><a href="#cb8-83"></a>plt.title(<span class="st">"Temperature Distribution on a Surface"</span>)</span>
<span id="cb8-84"><a href="#cb8-84"></a>plt.show()</span>
<span id="cb8-85"><a href="#cb8-85"></a></span>
<span id="cb8-86"><a href="#cb8-86"></a><span class="in">```</span></span>
<span id="cb8-87"><a href="#cb8-87"></a></span>
<span id="cb8-88"><a href="#cb8-88"></a>Above example defines a scalar field that do not depend on time. As we can see on weather maps, scalar fields can also be time-dependent, where the value of the field changes with time.</span>
<span id="cb8-89"><a href="#cb8-89"></a></span>
<span id="cb8-90"><a href="#cb8-90"></a>To define a time-dependent scalar field, we can modify the previous example by adding explicit time dependence:</span>
<span id="cb8-91"><a href="#cb8-91"></a></span>
<span id="cb8-92"><a href="#cb8-92"></a>$$</span>
<span id="cb8-93"><a href="#cb8-93"></a>T(x, y, t) = 5 \sin(x) \cos(y) e^{-t}</span>
<span id="cb8-94"><a href="#cb8-94"></a>$$</span>
<span id="cb8-95"><a href="#cb8-95"></a></span>
<span id="cb8-96"><a href="#cb8-96"></a>Now the temperature at each point $(x, y)$ decays exponentially with time. To visualize this field, we can use the following Python or Geogebra code in 3D calculator:</span>
<span id="cb8-97"><a href="#cb8-97"></a></span>
<span id="cb8-98"><a href="#cb8-98"></a>::: {.geogebra-instruction}</span>
<span id="cb8-99"><a href="#cb8-99"></a><span class="ss">* </span>t=Slider<span class="co">[</span><span class="ot">0,10,0.01</span><span class="co">]</span></span>
<span id="cb8-100"><a href="#cb8-100"></a><span class="ss">* </span>T(x,y)=5*sin(x)*cos(y)*exp(-t)</span>
<span id="cb8-101"><a href="#cb8-101"></a>:::</span>
<span id="cb8-102"><a href="#cb8-102"></a></span>
<span id="cb8-103"><a href="#cb8-103"></a>Or we can use the following Python code to grasp 4 time steps:</span>
<span id="cb8-104"><a href="#cb8-104"></a></span>
<span id="cb8-107"><a href="#cb8-107"></a><span class="in">```{python}</span></span>
<span id="cb8-108"><a href="#cb8-108"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-109"><a href="#cb8-109"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-110"><a href="#cb8-110"></a></span>
<span id="cb8-111"><a href="#cb8-111"></a><span class="co"># Scalar field definition</span></span>
<span id="cb8-112"><a href="#cb8-112"></a><span class="kw">def</span> scalar_field(x, y, t):</span>
<span id="cb8-113"><a href="#cb8-113"></a>    <span class="cf">return</span> <span class="dv">5</span> <span class="op">*</span> np.sin(x) <span class="op">*</span> np.cos(y) <span class="op">*</span> np.exp(<span class="op">-</span>t)</span>
<span id="cb8-114"><a href="#cb8-114"></a></span>
<span id="cb8-115"><a href="#cb8-115"></a><span class="co"># Generate grid points</span></span>
<span id="cb8-116"><a href="#cb8-116"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb8-117"><a href="#cb8-117"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span>
<span id="cb8-118"><a href="#cb8-118"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb8-119"><a href="#cb8-119"></a></span>
<span id="cb8-120"><a href="#cb8-120"></a><span class="co"># Compute scalar field values for 4 time steps</span></span>
<span id="cb8-121"><a href="#cb8-121"></a>T <span class="op">=</span> np.zeros((<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">4</span>))</span>
<span id="cb8-122"><a href="#cb8-122"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb8-123"><a href="#cb8-123"></a>    T[:, :, i] <span class="op">=</span> scalar_field(x, y, i)</span>
<span id="cb8-124"><a href="#cb8-124"></a></span>
<span id="cb8-125"><a href="#cb8-125"></a><span class="co"># Determine common color scale</span></span>
<span id="cb8-126"><a href="#cb8-126"></a>vmin <span class="op">=</span> np.<span class="bu">min</span>(T)</span>
<span id="cb8-127"><a href="#cb8-127"></a>vmax <span class="op">=</span> np.<span class="bu">max</span>(T)</span>
<span id="cb8-128"><a href="#cb8-128"></a></span>
<span id="cb8-129"><a href="#cb8-129"></a><span class="co"># Plot the scalar field for 4 time steps</span></span>
<span id="cb8-130"><a href="#cb8-130"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb8-131"><a href="#cb8-131"></a></span>
<span id="cb8-132"><a href="#cb8-132"></a><span class="co"># Store the last image for the colorbar</span></span>
<span id="cb8-133"><a href="#cb8-133"></a>im <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-134"><a href="#cb8-134"></a></span>
<span id="cb8-135"><a href="#cb8-135"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axs.flat):</span>
<span id="cb8-136"><a href="#cb8-136"></a>    ax.grid(<span class="va">False</span>)  <span class="co"># Explicitly disable gridlines</span></span>
<span id="cb8-137"><a href="#cb8-137"></a>    im <span class="op">=</span> ax.imshow(T[:, :, i], extent<span class="op">=</span>[<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>], origin<span class="op">=</span><span class="st">'lower'</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax)</span>
<span id="cb8-138"><a href="#cb8-138"></a>    ax.set_title(<span class="ss">f"Temperature Distribution at t=</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-139"><a href="#cb8-139"></a>    ax.set_xlabel(<span class="st">"X-axis"</span>)</span>
<span id="cb8-140"><a href="#cb8-140"></a>    ax.set_ylabel(<span class="st">"Y-axis"</span>)</span>
<span id="cb8-141"><a href="#cb8-141"></a></span>
<span id="cb8-142"><a href="#cb8-142"></a><span class="co"># Adjust layout to fit a colorbar outside the plots</span></span>
<span id="cb8-143"><a href="#cb8-143"></a>fig.subplots_adjust(right<span class="op">=</span><span class="fl">0.85</span>)</span>
<span id="cb8-144"><a href="#cb8-144"></a>cbar_ax <span class="op">=</span> fig.add_axes([<span class="fl">0.88</span>, <span class="fl">0.15</span>, <span class="fl">0.02</span>, <span class="fl">0.7</span>])  <span class="co"># Define a new axis for the colorbar</span></span>
<span id="cb8-145"><a href="#cb8-145"></a>cbar <span class="op">=</span> fig.colorbar(im, cax<span class="op">=</span>cbar_ax)</span>
<span id="cb8-146"><a href="#cb8-146"></a>cbar.set_label(<span class="st">"Temperature"</span>)</span>
<span id="cb8-147"><a href="#cb8-147"></a></span>
<span id="cb8-148"><a href="#cb8-148"></a>plt.show()</span>
<span id="cb8-149"><a href="#cb8-149"></a></span>
<span id="cb8-150"><a href="#cb8-150"></a><span class="in">```</span></span>
<span id="cb8-151"><a href="#cb8-151"></a></span>
<span id="cb8-152"><a href="#cb8-152"></a><span class="fu">## Vector Fields</span></span>
<span id="cb8-153"><a href="#cb8-153"></a></span>
<span id="cb8-154"><a href="#cb8-154"></a>A vector field assigns a vector to every point in space. In 2D, such a field can be represented as </span>
<span id="cb8-155"><a href="#cb8-155"></a></span>
<span id="cb8-156"><a href="#cb8-156"></a>$$\vec{F}(x, y) = (F_x(x, y), F_y(x, y))$$</span>
<span id="cb8-157"><a href="#cb8-157"></a></span>
<span id="cb8-158"><a href="#cb8-158"></a>where $F_x$ and $F_y$ are the components of the vector field. Both may depend on the position $(x, y)$.</span>
<span id="cb8-159"><a href="#cb8-159"></a></span>
<span id="cb8-160"><a href="#cb8-160"></a><span class="fu">### Example: Static vector field</span></span>
<span id="cb8-161"><a href="#cb8-161"></a></span>
<span id="cb8-162"><a href="#cb8-162"></a>Let us examine a vector field that depends on both space and time:</span>
<span id="cb8-163"><a href="#cb8-163"></a></span>
<span id="cb8-164"><a href="#cb8-164"></a>$$</span>
<span id="cb8-165"><a href="#cb8-165"></a>\vec{F}(x, y) = (\sin(y), \sqrt{\frac{|x|}{5}})</span>
<span id="cb8-166"><a href="#cb8-166"></a>$$</span>
<span id="cb8-167"><a href="#cb8-167"></a></span>
<span id="cb8-168"><a href="#cb8-168"></a>This field might represent the velocity of a fluid at each point $(x, y)$ in a 2D space. Below is a Python code to visualize this vector field:</span>
<span id="cb8-169"><a href="#cb8-169"></a></span>
<span id="cb8-172"><a href="#cb8-172"></a><span class="in">```{python}</span></span>
<span id="cb8-173"><a href="#cb8-173"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-174"><a href="#cb8-174"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-175"><a href="#cb8-175"></a></span>
<span id="cb8-176"><a href="#cb8-176"></a><span class="co"># Definition of the vector field</span></span>
<span id="cb8-177"><a href="#cb8-177"></a><span class="kw">def</span> vector_field(x, y):</span>
<span id="cb8-178"><a href="#cb8-178"></a>    Fx <span class="op">=</span> np.sin(y)</span>
<span id="cb8-179"><a href="#cb8-179"></a>    Fy <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(x)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb8-180"><a href="#cb8-180"></a>    <span class="cf">return</span> Fx, Fy</span>
<span id="cb8-181"><a href="#cb8-181"></a></span>
<span id="cb8-182"><a href="#cb8-182"></a><span class="co"># Generating a grid of points</span></span>
<span id="cb8-183"><a href="#cb8-183"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">16</span>)</span>
<span id="cb8-184"><a href="#cb8-184"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">16</span>)</span>
<span id="cb8-185"><a href="#cb8-185"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb8-186"><a href="#cb8-186"></a></span>
<span id="cb8-187"><a href="#cb8-187"></a><span class="co"># Calculating the vector field</span></span>
<span id="cb8-188"><a href="#cb8-188"></a>Fx, Fy <span class="op">=</span> vector_field(x, y)</span>
<span id="cb8-189"><a href="#cb8-189"></a></span>
<span id="cb8-190"><a href="#cb8-190"></a><span class="co"># Calculating the lengths of the vectors</span></span>
<span id="cb8-191"><a href="#cb8-191"></a>d_lengths <span class="op">=</span> np.sqrt(Fx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Fy<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb8-192"><a href="#cb8-192"></a></span>
<span id="cb8-193"><a href="#cb8-193"></a><span class="co"># Initializing the plot</span></span>
<span id="cb8-194"><a href="#cb8-194"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb8-195"><a href="#cb8-195"></a>quiver <span class="op">=</span> ax.quiver(</span>
<span id="cb8-196"><a href="#cb8-196"></a>    x, y, Fx, Fy, d_lengths, angles<span class="op">=</span><span class="st">'xy'</span>, scale_units<span class="op">=</span><span class="st">'xy'</span>, scale<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span><span class="st">'viridis'</span></span>
<span id="cb8-197"><a href="#cb8-197"></a>)</span>
<span id="cb8-198"><a href="#cb8-198"></a>cb <span class="op">=</span> fig.colorbar(quiver, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Vector length"</span>)</span>
<span id="cb8-199"><a href="#cb8-199"></a>ax.set_xlim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb8-200"><a href="#cb8-200"></a>ax.set_ylim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb8-201"><a href="#cb8-201"></a>ax.set_xlabel(<span class="st">"X axis"</span>)</span>
<span id="cb8-202"><a href="#cb8-202"></a>ax.set_ylabel(<span class="st">"Y axis"</span>)</span>
<span id="cb8-203"><a href="#cb8-203"></a>ax.set_title(<span class="st">"2D vector field with color dependent on vector length"</span>)</span>
<span id="cb8-204"><a href="#cb8-204"></a></span>
<span id="cb8-205"><a href="#cb8-205"></a>plt.show()</span>
<span id="cb8-206"><a href="#cb8-206"></a><span class="in">```</span></span>
<span id="cb8-207"><a href="#cb8-207"></a></span>
<span id="cb8-208"><a href="#cb8-208"></a></span>
<span id="cb8-209"><a href="#cb8-209"></a>Stream plot</span>
<span id="cb8-210"><a href="#cb8-210"></a></span>
<span id="cb8-213"><a href="#cb8-213"></a><span class="in">```{python}</span></span>
<span id="cb8-214"><a href="#cb8-214"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-215"><a href="#cb8-215"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-216"><a href="#cb8-216"></a></span>
<span id="cb8-217"><a href="#cb8-217"></a><span class="co"># Definition of the vector field</span></span>
<span id="cb8-218"><a href="#cb8-218"></a><span class="kw">def</span> vector_field(x, y):</span>
<span id="cb8-219"><a href="#cb8-219"></a>    Fx <span class="op">=</span> np.sin(y)</span>
<span id="cb8-220"><a href="#cb8-220"></a>    Fy <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(x)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb8-221"><a href="#cb8-221"></a>    <span class="cf">return</span> Fx, Fy</span>
<span id="cb8-222"><a href="#cb8-222"></a></span>
<span id="cb8-223"><a href="#cb8-223"></a><span class="co"># Generating a grid of points</span></span>
<span id="cb8-224"><a href="#cb8-224"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">100</span>)  <span class="co"># Higher resolution for streamlines</span></span>
<span id="cb8-225"><a href="#cb8-225"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">100</span>)</span>
<span id="cb8-226"><a href="#cb8-226"></a>x, y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb8-227"><a href="#cb8-227"></a></span>
<span id="cb8-228"><a href="#cb8-228"></a><span class="co"># Calculating the vector field</span></span>
<span id="cb8-229"><a href="#cb8-229"></a>Fx, Fy <span class="op">=</span> vector_field(x, y)</span>
<span id="cb8-230"><a href="#cb8-230"></a>d_lengths <span class="op">=</span> np.sqrt(Fx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> Fy<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb8-231"><a href="#cb8-231"></a></span>
<span id="cb8-232"><a href="#cb8-232"></a><span class="co"># Streamplot (Streamlines)</span></span>
<span id="cb8-233"><a href="#cb8-233"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb8-234"><a href="#cb8-234"></a>stream <span class="op">=</span> ax.streamplot(</span>
<span id="cb8-235"><a href="#cb8-235"></a>    x[<span class="dv">0</span>, :], y[:, <span class="dv">0</span>], Fx, Fy, color<span class="op">=</span>d_lengths, cmap<span class="op">=</span><span class="st">'viridis'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb8-236"><a href="#cb8-236"></a>)</span>
<span id="cb8-237"><a href="#cb8-237"></a>cb <span class="op">=</span> fig.colorbar(stream.lines, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Vector length"</span>)</span>
<span id="cb8-238"><a href="#cb8-238"></a>ax.set_xlim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb8-239"><a href="#cb8-239"></a>ax.set_ylim(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb8-240"><a href="#cb8-240"></a>ax.set_xlabel(<span class="st">"X axis"</span>)</span>
<span id="cb8-241"><a href="#cb8-241"></a>ax.set_ylabel(<span class="st">"Y axis"</span>)</span>
<span id="cb8-242"><a href="#cb8-242"></a>ax.set_title(<span class="st">"2D Vector Field with Streamlines"</span>)</span>
<span id="cb8-243"><a href="#cb8-243"></a>plt.show()</span>
<span id="cb8-244"><a href="#cb8-244"></a><span class="in">```</span></span>
<span id="cb8-245"><a href="#cb8-245"></a></span>
<span id="cb8-246"><a href="#cb8-246"></a><span class="fu">## Derivatives and Integrals</span></span>
<span id="cb8-247"><a href="#cb8-247"></a></span>
<span id="cb8-248"><a href="#cb8-248"></a><span class="fu">### Derivatives</span></span>
<span id="cb8-249"><a href="#cb8-249"></a></span>
<span id="cb8-250"><a href="#cb8-250"></a><span class="fu">#### Derivative of functions of one variable</span></span>
<span id="cb8-251"><a href="#cb8-251"></a></span>
<span id="cb8-252"><a href="#cb8-252"></a>The derivative of a function $f(x)$ with respect to $x$ is defined as</span>
<span id="cb8-253"><a href="#cb8-253"></a></span>
<span id="cb8-254"><a href="#cb8-254"></a>$$</span>
<span id="cb8-255"><a href="#cb8-255"></a>\frac{df(x)}{dx} = \lim_{h \to 0} \frac{f(x + h) - f(x)}{h}</span>
<span id="cb8-256"><a href="#cb8-256"></a>$$</span>
<span id="cb8-257"><a href="#cb8-257"></a></span>
<span id="cb8-258"><a href="#cb8-258"></a>This limit represents the rate of change of the function $f(x)$ with respect to $x$. The derivative is a measure of how the function changes as $x$ changes. The derivative can be interpreted as the slope of the function at a given point. The derivative is a function that gives the slope of the function at each point.</span>
<span id="cb8-259"><a href="#cb8-259"></a></span>
<span id="cb8-260"><a href="#cb8-260"></a><span class="fu">#### Derivative of functions of two variables</span></span>
<span id="cb8-261"><a href="#cb8-261"></a></span>
<span id="cb8-262"><a href="#cb8-262"></a>The derivative of a function $f(x, y)$ with respect to $x$ is defined as</span>
<span id="cb8-263"><a href="#cb8-263"></a></span>
<span id="cb8-264"><a href="#cb8-264"></a>$$</span>
<span id="cb8-265"><a href="#cb8-265"></a>\frac{\partial f(x, y)}{\partial x} = \lim_{h \to 0} \frac{f(x + h, y) - f(x, y)}{h}</span>
<span id="cb8-266"><a href="#cb8-266"></a>$$</span>
<span id="cb8-267"><a href="#cb8-267"></a></span>
<span id="cb8-268"><a href="#cb8-268"></a>This limit represents the rate of change of the function $f(x, y)$ with respect to $x$. The derivative is a measure of how the function changes as $x$ changes. This describes how the function changes in the $x$ direction. </span>
<span id="cb8-269"><a href="#cb8-269"></a></span>
<span id="cb8-270"><a href="#cb8-270"></a>Similarly, the derivative of a function $f(x, y)$ with respect to $y$ is defined as</span>
<span id="cb8-271"><a href="#cb8-271"></a></span>
<span id="cb8-272"><a href="#cb8-272"></a>$$</span>
<span id="cb8-273"><a href="#cb8-273"></a>\frac{\partial f(x, y)}{\partial y} = \lim_{h \to 0} \frac{f(x, y + h) - f(x, y)}{h}</span>
<span id="cb8-274"><a href="#cb8-274"></a>$$</span>
<span id="cb8-275"><a href="#cb8-275"></a></span>
<span id="cb8-276"><a href="#cb8-276"></a>This limit represents the rate of change of the function $f(x, y)$ with respect to $y$. The derivative is a measure of how the function changes as $y$ changes. This describes how the function changes in the $y$ direction.</span>
<span id="cb8-277"><a href="#cb8-277"></a></span>
<span id="cb8-278"><a href="#cb8-278"></a><span class="fu">### Integrals</span></span>
<span id="cb8-279"><a href="#cb8-279"></a></span>
<span id="cb8-280"><a href="#cb8-280"></a>At the simplest level, an integral is the reverse of a derivative. The integral of a function $f(x)$ with respect to $x$ is defined as</span>
<span id="cb8-281"><a href="#cb8-281"></a></span>
<span id="cb8-282"><a href="#cb8-282"></a>$$</span>
<span id="cb8-283"><a href="#cb8-283"></a>\int f(x) dx = F(x) + C</span>
<span id="cb8-284"><a href="#cb8-284"></a>$$</span>
<span id="cb8-285"><a href="#cb8-285"></a></span>
<span id="cb8-286"><a href="#cb8-286"></a>where $F(x)$ is the antiderivative of $f(x)$ and $C$ is an integration constant. The antiderivative is a function whose derivative is equal to $f(x)$:</span>
<span id="cb8-287"><a href="#cb8-287"></a></span>
<span id="cb8-288"><a href="#cb8-288"></a>$$</span>
<span id="cb8-289"><a href="#cb8-289"></a>\frac{dF(x)}{dx} = f(x)</span>
<span id="cb8-290"><a href="#cb8-290"></a>$$</span>
<span id="cb8-291"><a href="#cb8-291"></a></span>
<span id="cb8-292"><a href="#cb8-292"></a>The integral is a measure of the area under the curve of the function $f(x)$. The integral is a function that gives the area under the curve of the function $f(x)$ up to a given point.</span>
<span id="cb8-293"><a href="#cb8-293"></a></span>
<span id="cb8-294"><a href="#cb8-294"></a><span class="fu">## Differential equations</span></span>
<span id="cb8-295"><a href="#cb8-295"></a></span>
<span id="cb8-296"><a href="#cb8-296"></a><span class="fu">### Starting example</span></span>
<span id="cb8-297"><a href="#cb8-297"></a></span>
<span id="cb8-298"><a href="#cb8-298"></a>Let's consider the first order differential equation</span>
<span id="cb8-299"><a href="#cb8-299"></a></span>
<span id="cb8-300"><a href="#cb8-300"></a>::: {.equation-box}</span>
<span id="cb8-301"><a href="#cb8-301"></a>$$</span>
<span id="cb8-302"><a href="#cb8-302"></a>\frac{dy(x)}{dx} = 2x</span>
<span id="cb8-303"><a href="#cb8-303"></a>$$</span>
<span id="cb8-304"><a href="#cb8-304"></a>:::</span>
<span id="cb8-305"><a href="#cb8-305"></a></span>
<span id="cb8-306"><a href="#cb8-306"></a>Let us think how we should read this equation. The left hand side is the derivative of the function $y(x)$ with respect to $x$. This derivative is equal to 3. This means that the slope of the function $y(x)$ is constant and equal to 3. This is a simple differential equation that can be solved by integration. The solution is</span>
<span id="cb8-307"><a href="#cb8-307"></a></span>
<span id="cb8-308"><a href="#cb8-308"></a>$$</span>
<span id="cb8-309"><a href="#cb8-309"></a>y(x) = x^2 + C</span>
<span id="cb8-310"><a href="#cb8-310"></a>$$</span>
<span id="cb8-311"><a href="#cb8-311"></a></span>
<span id="cb8-312"><a href="#cb8-312"></a>where $C$ is an integration constant. This is the general solution of the differential equation. The solution is not unique because the constant $C$ can take any value. The solution is a straight line with slope 3. The constant $C$ determines the position of the line in the $y$-axis.</span>
<span id="cb8-313"><a href="#cb8-313"></a></span>
<span id="cb8-316"><a href="#cb8-316"></a><span class="in">```{python}</span></span>
<span id="cb8-317"><a href="#cb8-317"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-318"><a href="#cb8-318"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-319"><a href="#cb8-319"></a></span>
<span id="cb8-320"><a href="#cb8-320"></a><span class="kw">def</span> y(x, C):</span>
<span id="cb8-321"><a href="#cb8-321"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> C</span>
<span id="cb8-322"><a href="#cb8-322"></a></span>
<span id="cb8-323"><a href="#cb8-323"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb8-324"><a href="#cb8-324"></a></span>
<span id="cb8-325"><a href="#cb8-325"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb8-326"><a href="#cb8-326"></a></span>
<span id="cb8-327"><a href="#cb8-327"></a><span class="cf">for</span> C <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">10</span>):</span>
<span id="cb8-328"><a href="#cb8-328"></a>    plt.plot(x, y(x, C), label<span class="op">=</span><span class="ss">f'C=</span><span class="sc">{</span>C<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb8-329"><a href="#cb8-329"></a></span>
<span id="cb8-330"><a href="#cb8-330"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-331"><a href="#cb8-331"></a>plt.ylabel(<span class="st">'y'</span>)</span>
<span id="cb8-332"><a href="#cb8-332"></a>plt.show()</span>
<span id="cb8-333"><a href="#cb8-333"></a><span class="in">```</span></span>
<span id="cb8-334"><a href="#cb8-334"></a></span>
<span id="cb8-335"><a href="#cb8-335"></a><span class="fu">#### Check in geogebra:</span></span>
<span id="cb8-336"><a href="#cb8-336"></a></span>
<span id="cb8-337"><a href="#cb8-337"></a>::: {.geogebra-instruction}</span>
<span id="cb8-338"><a href="#cb8-338"></a><span class="ss">* </span>f(x) =  x^2 + 3</span>
<span id="cb8-339"><a href="#cb8-339"></a>:::</span>
<span id="cb8-340"><a href="#cb8-340"></a></span>
<span id="cb8-341"><a href="#cb8-341"></a><span class="fu">##### Numerical solution</span></span>
<span id="cb8-342"><a href="#cb8-342"></a></span>
<span id="cb8-343"><a href="#cb8-343"></a>Remember that derivatives can be approximated by finite differences. The derivative of a function $f(x)$ can be approximated by</span>
<span id="cb8-344"><a href="#cb8-344"></a></span>
<span id="cb8-345"><a href="#cb8-345"></a>$$</span>
<span id="cb8-346"><a href="#cb8-346"></a>\frac{df(x)}{dx} \approx \frac{f(x + h) - f(x)}{h}</span>
<span id="cb8-347"><a href="#cb8-347"></a>$$</span>
<span id="cb8-348"><a href="#cb8-348"></a></span>
<span id="cb8-349"><a href="#cb8-349"></a>where $h$ is a small number. This is a simple way to approximate the derivative of a function. Let's use this approximation to solve the differential equation</span>
<span id="cb8-350"><a href="#cb8-350"></a></span>
<span id="cb8-351"><a href="#cb8-351"></a>$$</span>
<span id="cb8-352"><a href="#cb8-352"></a>\frac{dy(x)}{dx} = 2x</span>
<span id="cb8-353"><a href="#cb8-353"></a>$$</span>
<span id="cb8-354"><a href="#cb8-354"></a></span>
<span id="cb8-355"><a href="#cb8-355"></a>We can approximate the derivative by</span>
<span id="cb8-356"><a href="#cb8-356"></a></span>
<span id="cb8-357"><a href="#cb8-357"></a>$$</span>
<span id="cb8-358"><a href="#cb8-358"></a>\frac{y(x + h) - y(x)}{h} = 2x</span>
<span id="cb8-359"><a href="#cb8-359"></a>$$</span>
<span id="cb8-360"><a href="#cb8-360"></a></span>
<span id="cb8-361"><a href="#cb8-361"></a>This equation can be solved for $y(x + h)$</span>
<span id="cb8-362"><a href="#cb8-362"></a></span>
<span id="cb8-363"><a href="#cb8-363"></a>$$</span>
<span id="cb8-364"><a href="#cb8-364"></a>y(x + h) = y(x) + 2xh</span>
<span id="cb8-365"><a href="#cb8-365"></a>$$</span>
<span id="cb8-366"><a href="#cb8-366"></a></span>
<span id="cb8-367"><a href="#cb8-367"></a>This equation can be used to solve the differential equation numerically. We can start from an initial value of $y(x)$ and use the equation above to calculate the value of $y(x + h)$. This value can be used to calculate the next value of $y(x + 2h)$ and so on. This is a simple numerical method to solve differential equations.</span>
<span id="cb8-368"><a href="#cb8-368"></a></span>
<span id="cb8-369"><a href="#cb8-369"></a>Let us compare the numerical solution with the analytical solution.</span>
<span id="cb8-370"><a href="#cb8-370"></a></span>
<span id="cb8-373"><a href="#cb8-373"></a><span class="in">```{python}</span></span>
<span id="cb8-374"><a href="#cb8-374"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-375"><a href="#cb8-375"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-376"><a href="#cb8-376"></a></span>
<span id="cb8-377"><a href="#cb8-377"></a><span class="co"># Define the derivative dy/dx</span></span>
<span id="cb8-378"><a href="#cb8-378"></a><span class="kw">def</span> dy_dx(x):</span>
<span id="cb8-379"><a href="#cb8-379"></a>    <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> x</span>
<span id="cb8-380"><a href="#cb8-380"></a></span>
<span id="cb8-381"><a href="#cb8-381"></a><span class="co"># Define the exact analytical solution y(x) for comparison</span></span>
<span id="cb8-382"><a href="#cb8-382"></a><span class="kw">def</span> y_analytical(x):</span>
<span id="cb8-383"><a href="#cb8-383"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb8-384"><a href="#cb8-384"></a></span>
<span id="cb8-385"><a href="#cb8-385"></a><span class="co"># Define a numerical solution for y(x) using the forward Euler method</span></span>
<span id="cb8-386"><a href="#cb8-386"></a><span class="kw">def</span> y_numerical(x, h):</span>
<span id="cb8-387"><a href="#cb8-387"></a>    y <span class="op">=</span> [<span class="dv">0</span>]  <span class="co"># Initialize y with the starting value, assuming y(0) = 0</span></span>
<span id="cb8-388"><a href="#cb8-388"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb8-389"><a href="#cb8-389"></a>        y.append(y[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> dy_dx(x[i]) <span class="op">*</span> h)  <span class="co"># Update y using dy/dx</span></span>
<span id="cb8-390"><a href="#cb8-390"></a>    <span class="cf">return</span> y</span>
<span id="cb8-391"><a href="#cb8-391"></a></span>
<span id="cb8-392"><a href="#cb8-392"></a><span class="co"># Set up the x values</span></span>
<span id="cb8-393"><a href="#cb8-393"></a>plot_x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb8-394"><a href="#cb8-394"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb8-395"><a href="#cb8-395"></a>h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]  <span class="co"># Step size</span></span>
<span id="cb8-396"><a href="#cb8-396"></a></span>
<span id="cb8-397"><a href="#cb8-397"></a><span class="co"># Compute the difference between analytical and numerical solutions</span></span>
<span id="cb8-398"><a href="#cb8-398"></a>difference <span class="op">=</span> y_analytical(x) <span class="op">-</span> np.array(y_numerical(x, h))</span>
<span id="cb8-399"><a href="#cb8-399"></a></span>
<span id="cb8-400"><a href="#cb8-400"></a><span class="co"># Set up the figure with two subplots</span></span>
<span id="cb8-401"><a href="#cb8-401"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb8-402"><a href="#cb8-402"></a></span>
<span id="cb8-403"><a href="#cb8-403"></a><span class="co"># Left plot: Analytical and numerical solutions</span></span>
<span id="cb8-404"><a href="#cb8-404"></a>axs[<span class="dv">0</span>].plot(plot_x, y_analytical(plot_x), label<span class="op">=</span><span class="st">'Analytical'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-405"><a href="#cb8-405"></a>axs[<span class="dv">0</span>].scatter(x, y_numerical(x, h), label<span class="op">=</span><span class="st">'Numerical'</span>, linestyle<span class="op">=</span><span class="st">'solid'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb8-406"><a href="#cb8-406"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Analytical vs Numerical'</span>)</span>
<span id="cb8-407"><a href="#cb8-407"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-408"><a href="#cb8-408"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb8-409"><a href="#cb8-409"></a>axs[<span class="dv">0</span>].legend()</span>
<span id="cb8-410"><a href="#cb8-410"></a></span>
<span id="cb8-411"><a href="#cb8-411"></a><span class="co"># Right plot: Difference between solutions</span></span>
<span id="cb8-412"><a href="#cb8-412"></a>axs[<span class="dv">1</span>].scatter(x, difference, label<span class="op">=</span><span class="st">'Difference'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb8-413"><a href="#cb8-413"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Difference (Analytical - Numerical)'</span>)</span>
<span id="cb8-414"><a href="#cb8-414"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-415"><a href="#cb8-415"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Difference'</span>)</span>
<span id="cb8-416"><a href="#cb8-416"></a>axs[<span class="dv">1</span>].legend()</span>
<span id="cb8-417"><a href="#cb8-417"></a></span>
<span id="cb8-418"><a href="#cb8-418"></a><span class="co"># Adjust layout and show the plots</span></span>
<span id="cb8-419"><a href="#cb8-419"></a>plt.tight_layout()</span>
<span id="cb8-420"><a href="#cb8-420"></a>plt.show()</span>
<span id="cb8-421"><a href="#cb8-421"></a></span>
<span id="cb8-422"><a href="#cb8-422"></a><span class="in">```</span></span>
<span id="cb8-423"><a href="#cb8-423"></a></span>
<span id="cb8-424"><a href="#cb8-424"></a>Difference between the analytical and numerical solutions depends on the step size $h$. </span>
<span id="cb8-425"><a href="#cb8-425"></a></span>
<span id="cb8-426"><a href="#cb8-426"></a><span class="fu">### Second order differential equations</span></span>
<span id="cb8-427"><a href="#cb8-427"></a></span>
<span id="cb8-428"><a href="#cb8-428"></a>Let's consider the second order differential equation</span>
<span id="cb8-429"><a href="#cb8-429"></a></span>
<span id="cb8-430"><a href="#cb8-430"></a>$$</span>
<span id="cb8-431"><a href="#cb8-431"></a>\frac{d^2y(x)}{dx^2} = -y(x)</span>
<span id="cb8-432"><a href="#cb8-432"></a>$$</span>
<span id="cb8-433"><a href="#cb8-433"></a></span>
<span id="cb8-434"><a href="#cb8-434"></a>This is a simple differential equation that can be solved by integration. The solution is</span>
<span id="cb8-435"><a href="#cb8-435"></a></span>
<span id="cb8-436"><a href="#cb8-436"></a>$$</span>
<span id="cb8-437"><a href="#cb8-437"></a>y(x) = A \sin(x) + B \cos(x)</span>
<span id="cb8-438"><a href="#cb8-438"></a>$$</span>
<span id="cb8-439"><a href="#cb8-439"></a></span>
<span id="cb8-440"><a href="#cb8-440"></a>where $A$ and $B$ are integration constants. This is the general solution of the differential equation. The solution is not unique because the constants $A$ and $B$ can take any value. The solution is a sinusoidal function. The constants $A$ and $B$ determine the amplitude and phase of the sinusoidal function.</span>
<span id="cb8-441"><a href="#cb8-441"></a></span>
<span id="cb8-442"><a href="#cb8-442"></a><span class="fu">#### Numerical solution</span></span>
<span id="cb8-443"><a href="#cb8-443"></a></span>
<span id="cb8-444"><a href="#cb8-444"></a>From Taylor's theorem, we know that the second derivative of a function $f(x)$ can be approximated by</span>
<span id="cb8-445"><a href="#cb8-445"></a></span>
<span id="cb8-446"><a href="#cb8-446"></a>$$</span>
<span id="cb8-447"><a href="#cb8-447"></a>f(x + h) = f(x) + h \frac{df(x)}{dx} + \frac{h^2}{2} \frac{d^2f(x)}{dx^2} + \ldots</span>
<span id="cb8-448"><a href="#cb8-448"></a>$$</span>
<span id="cb8-449"><a href="#cb8-449"></a></span>
<span id="cb8-450"><a href="#cb8-450"></a>also</span>
<span id="cb8-451"><a href="#cb8-451"></a></span>
<span id="cb8-452"><a href="#cb8-452"></a>$$</span>
<span id="cb8-453"><a href="#cb8-453"></a>f(x - h) = f(x) - h \frac{df(x)}{dx} + \frac{h^2}{2} \frac{d^2f(x)}{dx^2} + \ldots</span>
<span id="cb8-454"><a href="#cb8-454"></a>$$</span>
<span id="cb8-455"><a href="#cb8-455"></a></span>
<span id="cb8-456"><a href="#cb8-456"></a>adding these two equations we get</span>
<span id="cb8-457"><a href="#cb8-457"></a></span>
<span id="cb8-458"><a href="#cb8-458"></a>$$</span>
<span id="cb8-459"><a href="#cb8-459"></a>f(x + h) + f(x - h) = 2 f(x) + h^2 \frac{d^2f(x)}{dx^2}</span>
<span id="cb8-460"><a href="#cb8-460"></a>$$</span>
<span id="cb8-461"><a href="#cb8-461"></a></span>
<span id="cb8-462"><a href="#cb8-462"></a>so we can approximate the second derivative by</span>
<span id="cb8-463"><a href="#cb8-463"></a></span>
<span id="cb8-464"><a href="#cb8-464"></a>$$</span>
<span id="cb8-465"><a href="#cb8-465"></a>\frac{f(x + h) + f(x - h) - 2 f(x)}{h^2} \approx \frac{d^2f(x)}{dx^2}</span>
<span id="cb8-466"><a href="#cb8-466"></a>$$</span>
<span id="cb8-467"><a href="#cb8-467"></a></span>
<span id="cb8-468"><a href="#cb8-468"></a>Let's use this approximation to solve the differential equation</span>
<span id="cb8-469"><a href="#cb8-469"></a></span>
<span id="cb8-470"><a href="#cb8-470"></a>$$</span>
<span id="cb8-471"><a href="#cb8-471"></a>\frac{d^2y(x)}{dx^2} = -y(x)</span>
<span id="cb8-472"><a href="#cb8-472"></a>$$</span>
<span id="cb8-473"><a href="#cb8-473"></a></span>
<span id="cb8-474"><a href="#cb8-474"></a>We can approximate the second derivative by</span>
<span id="cb8-475"><a href="#cb8-475"></a></span>
<span id="cb8-476"><a href="#cb8-476"></a>$$</span>
<span id="cb8-477"><a href="#cb8-477"></a>\frac{y(x + h) + y(x - h) - 2 y(x)}{h^2} = -y(x)</span>
<span id="cb8-478"><a href="#cb8-478"></a>$$</span>
<span id="cb8-479"><a href="#cb8-479"></a></span>
<span id="cb8-480"><a href="#cb8-480"></a>This equation can be solved for $y(x + h)$</span>
<span id="cb8-481"><a href="#cb8-481"></a></span>
<span id="cb8-482"><a href="#cb8-482"></a>$$</span>
<span id="cb8-483"><a href="#cb8-483"></a>y(x + h) = 2 y(x) - y(x - h) - h^2 y(x)</span>
<span id="cb8-484"><a href="#cb8-484"></a>$$</span>
<span id="cb8-485"><a href="#cb8-485"></a></span>
<span id="cb8-486"><a href="#cb8-486"></a>This equation can be used to solve the differential equation numerically. We can start from an initial value of $y(x)$ and $y(x - h)$ and use the equation above to calculate the value of $y(x + h)$. This value can be used to calculate the next value of $y(x + 2h)$ and so on. This is a simple numerical method to solve differential equations.</span>
<span id="cb8-487"><a href="#cb8-487"></a></span>
<span id="cb8-488"><a href="#cb8-488"></a>Let us compare the numerical solution with the analytical solution.</span>
<span id="cb8-489"><a href="#cb8-489"></a></span>
<span id="cb8-492"><a href="#cb8-492"></a><span class="in">```{python}</span></span>
<span id="cb8-493"><a href="#cb8-493"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-494"><a href="#cb8-494"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-495"><a href="#cb8-495"></a></span>
<span id="cb8-496"><a href="#cb8-496"></a><span class="co"># Define the second derivative d^2y/dx^2</span></span>
<span id="cb8-497"><a href="#cb8-497"></a><span class="kw">def</span> d2y_dx2(x):</span>
<span id="cb8-498"><a href="#cb8-498"></a>    <span class="cf">return</span> <span class="op">-</span>x</span>
<span id="cb8-499"><a href="#cb8-499"></a></span>
<span id="cb8-500"><a href="#cb8-500"></a><span class="co"># Define the exact analytical solution y(x) for comparison</span></span>
<span id="cb8-501"><a href="#cb8-501"></a><span class="kw">def</span> y_analytical(x):</span>
<span id="cb8-502"><a href="#cb8-502"></a>    <span class="cf">return</span> <span class="op">-</span>np.sin(x)</span>
<span id="cb8-503"><a href="#cb8-503"></a></span>
<span id="cb8-504"><a href="#cb8-504"></a><span class="co"># Define a numerical solution for y(x) using the forward Euler method</span></span>
<span id="cb8-505"><a href="#cb8-505"></a><span class="kw">def</span> y_numerical(x, h):</span>
<span id="cb8-506"><a href="#cb8-506"></a>    y <span class="op">=</span> [<span class="dv">0</span>, np.sin(<span class="op">-</span>h)]  <span class="co"># Initialize y with the starting values, assuming y(0) = 0 and y(-h) = sin(-h)</span></span>
<span id="cb8-507"><a href="#cb8-507"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb8-508"><a href="#cb8-508"></a>        y.append(<span class="dv">2</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> y[<span class="op">-</span><span class="dv">2</span>] <span class="op">-</span> h<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> y[<span class="op">-</span><span class="dv">1</span>])  <span class="co"># Update y using d^2y/dx^2</span></span>
<span id="cb8-509"><a href="#cb8-509"></a>    <span class="cf">return</span> y</span>
<span id="cb8-510"><a href="#cb8-510"></a></span>
<span id="cb8-511"><a href="#cb8-511"></a><span class="co"># Set up the x values</span></span>
<span id="cb8-512"><a href="#cb8-512"></a>plot_x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb8-513"><a href="#cb8-513"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb8-514"><a href="#cb8-514"></a>h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]  <span class="co"># Step size</span></span>
<span id="cb8-515"><a href="#cb8-515"></a></span>
<span id="cb8-516"><a href="#cb8-516"></a><span class="co"># Compute the difference between analytical and numerical solutions</span></span>
<span id="cb8-517"><a href="#cb8-517"></a>difference <span class="op">=</span> y_analytical(x) <span class="op">-</span> np.array(y_numerical(x, h))</span>
<span id="cb8-518"><a href="#cb8-518"></a></span>
<span id="cb8-519"><a href="#cb8-519"></a><span class="co"># Set up the figure with two subplots</span></span>
<span id="cb8-520"><a href="#cb8-520"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb8-521"><a href="#cb8-521"></a></span>
<span id="cb8-522"><a href="#cb8-522"></a><span class="co"># Left plot: Analytical and numerical solutions</span></span>
<span id="cb8-523"><a href="#cb8-523"></a>axs[<span class="dv">0</span>].plot(plot_x, y_analytical(plot_x), label<span class="op">=</span><span class="st">'Analytical'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-524"><a href="#cb8-524"></a>axs[<span class="dv">0</span>].scatter(x, y_numerical(x, h), label<span class="op">=</span><span class="st">'Numerical'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb8-525"><a href="#cb8-525"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Analytical vs Numerical'</span>)</span>
<span id="cb8-526"><a href="#cb8-526"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-527"><a href="#cb8-527"></a></span>
<span id="cb8-528"><a href="#cb8-528"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb8-529"><a href="#cb8-529"></a>axs[<span class="dv">0</span>].legend()</span>
<span id="cb8-530"><a href="#cb8-530"></a></span>
<span id="cb8-531"><a href="#cb8-531"></a><span class="co"># Right plot: Difference between solutions</span></span>
<span id="cb8-532"><a href="#cb8-532"></a>axs[<span class="dv">1</span>].scatter(x, difference, label<span class="op">=</span><span class="st">'Difference'</span>)</span>
<span id="cb8-533"><a href="#cb8-533"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Difference (Analytical - Numerical)'</span>)</span>
<span id="cb8-534"><a href="#cb8-534"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-535"><a href="#cb8-535"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Difference'</span>)</span>
<span id="cb8-536"><a href="#cb8-536"></a>axs[<span class="dv">1</span>].legend()</span>
<span id="cb8-537"><a href="#cb8-537"></a></span>
<span id="cb8-538"><a href="#cb8-538"></a><span class="co"># Adjust layout and show the plots</span></span>
<span id="cb8-539"><a href="#cb8-539"></a>plt.tight_layout()</span>
<span id="cb8-540"><a href="#cb8-540"></a>plt.show()</span>
<span id="cb8-541"><a href="#cb8-541"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>